<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cinema.mapper.MemberManagerMapper">

	<select id="memberGetListWithPaging"
		resultType="com.cinema.domain.MemberManagerDto">
	<![CDATA[
		SELECT * FROM (SELECT /*+INDEX_DESC(MANAGER_MEMBER MANAGER_MEMBER_PK)*/
		ROWNUM RN, MEMBERNO, MEMBERID, MEMBERNICKNAME, MEMBERBIRTH, MEMBERGENDER, MEMBERAUTHORITY
		CREATETIME, RECENTTIME FROM MANAGER_MEMBER WHERE ROWNUM <= (#{pageNum}*10)) WHERE RN > (#{pageNum}-1)
	]]>
	</select>

	<select id="memberGetTotalCount" resultType="int">
	<![CDATA[
		SELECT COUNT(*) FROM MANAGER_MEMBER WHERE MEMBERNO>0	
	]]>
	</select>

	<select id="memberDetail"
		resultType="com.cinema.domain.MemberManagerDto">
	<![CDATA[	
		SELECT * FROM MANAGER_MEMBER WHERE MEMBERNO=#{memberNo}
		]]>
	</select>

	<update id="memberDetailModify">
	<![CDATA[	
		UPDATE MANAGER_MEMBER SET MEMBERAUTHORITY=#{memberAuthority} , MEMBERNICKNAME=#{memberNickname} WHERE MEMBERNO=#{memberNo}
	]]>
	</update>

	<select id="memberSearch"
		resultType="com.cinema.domain.MemberManagerDto">
	<![CDATA[	
		SELECT * FROM MANAGER_MEMBER WHERE
	]]>
		<choose>
			<when test="type == 'memberId'">
				MEMBERNO IN(SELECT MEMBERNO FROM MANAGER_MEMBER WHERE
				MEMBERID=#{keyword})
			</when>
		</choose>
	</select>
</mapper>